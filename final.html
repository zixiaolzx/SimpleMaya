<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Final Project</title>

    <link href="resources/bootstrap.min.css" rel="stylesheet">
    <link href="resources/custom2016.css" rel="stylesheet">
    <script src="resources/jquery.min.js"></script>
    <script src="resources/bootstrap.min.js"></script>
    
	<script src="resources/common.js"></script>
    <script src="resources/glUtil.js"></script>
    <script src="resources/uiUtil.js"></script>
	<script src="resources/vector.js"></script>
    <script src="resources/matrix.js"></script>
    <script src="resources/cube.js"></script>
	<script src="resources/arm.js"></script>
	<script src="resources/skeleton.js"></script>
	<script src="resources/joint.js"></script>
	<script src="resources/skin.js"></script>

    <script src="resources/catmullromspline.js"></script>
	<script src="resources/drawutils.js"></script>
    <script src="resources/node.js"></script>
	<!-- Add all tasks -->
	<script src="resources/task3.js"></script>

    <script src="resources/geometry.js"></script>
    <script src="resources/mesh.js"></script>


<style>

</style>
</head>

<body onload="setupAssignment();">
    <div class="container headerBar">
        <h1>Final Project</h1>
    </div>
    <div class="container contentWrapper">
        <div class="pageContent">
            <!-- ================================================================= -->
            <h2>Animation Graph Editor</h2>
            
            <p> </p>
            <div>
                <div style="float:left;margin:80px 0 0 50px">


<!--                     <div style="text-align: center;user-select: none; -webkit-user-select: none; -moz-user-select: none; margin:0 0 60px 0;">
                        <button id="load" class = "dropbtn btn" style="width:120px; height:50px; text-align:center" onclick="loadmesh()">Mesh</button>
                        <div id="myDropdown" class="dropdown-content">
                            <button id="load0" onclick="loadm()" class="btn btn-default">Cube</button>
                            <button id="load1" onclick="loadm()" class="btn btn-default">Torus</button>
                            <button id="load2" onclick="loadm()" class="btn btn-default">Sphere</button>
                            <button id="load3" onclick="loadm()" class="btn btn-default">Icosahedron</button>
                            <button id="load4" onclick="loadm()" class="btn btn-default">Octahedron</button>
                            <button id="load5" onclick="loadarm()" class="btn btn-default">Arm</button>
                        </div>
                    </div> -->


                    <div class="dropdown" style="text-align: center;user-select: none; -webkit-user-select: none; -moz-user-select: none; margin:0 0 60px 0;">
                        <button id="load" 
                                class="btn btn-success dropdown-toggle" 
                                type="button" 
                                data-toggle="dropdown"
                                style="width:120px; height:50px; text-align:center">
                            Mesh
                        <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" id="myDropdown">
                            <li><a id="load0" onclick="loadm()" >Cube</a></li>
                            <li><a id="load1" onclick="loadm()" >Torus</a></li>
                            <li><a id="load2" onclick="loadm()" >Sphere</a></li>
                            <li><a id="load3" onclick="loadm()" >Icosahedron</a></li>
                            <li><a id="load4" onclick="loadm()" >Octahedron</a></li>
                            <li class="divider"></li>
                            <li><a id="load5" onclick="loadarm()" >Arm</a></li>
                        </ul>
                    </div>


                    <div style="text-align: center; user-select: none; -webkit-user-select: none; -moz-user-select: none; margin:0 0 5px 0;">
                    <button class = "btn btn-default" id="saveKey" style="width:120px; height:50px">Save Keys</button>
                    </div>

                    <div style="text-align: center; user-select: none; -webkit-user-select: none; -moz-user-select: none; margin:0 0 60px 0;">
                    <button class = "btn btn-default" id="loadKey" style="width:120px; height:50px">Load Keys</button>
                    </div>

                    <div style="text-align:center; user-select: none; -webkit-user-select: none; -moz-user-select: none;  margin:0 0 120px 0;">
                    <button id="play" class = "btn btn-danger" style="width:120px; height:50px" onclick="changeText()">Play</button>
                    </div>

                </div>
                
                </div>
                <div class="canvas-container">
                <div style="float:center;margin:30px 0 0 220px">
    				<canvas id="task-1" width="820" height="461"></canvas>
                </div>
                </div>
            </div>

            <div style ="margin:0 0 0 0">

                <div class="btn-group-vertical" style="float:left;margin:-15px 0px 0px 20px">
                    <button id="axis_tx" class="btn btn-primary">translation X</button>
                    <button id="axis_ty" class="btn btn-default">translation Y</button>
                    <button id="axis_tz" class="btn btn-default">translation Z</button>
                    <button id="axis_rx" class="btn btn-default">rotation X</button>
                    <button id="axis_ry" class="btn btn-default">rotation Y</button>
                    <button id="axis_rz" class="btn btn-default">rotation Z</button>
                </div>

                <div style = "width:50px;float:left;margin:-15px 0 0 20px;"">
                    <form class="form-inline" action="/action_page.php">
                      <input id = "value" type="text" name="Time" placeholder = "0~152" class="form-control" style = "width:75px"">
                    </form>
                    <div class="btn-group-vertical" style="text-align: center;user-select: none; -webkit-user-select: none; -moz-user-select: none;margin:10px 0 51px 0;">
                    <button id= "setnode" class="btn btn-default">Set Key</button>
                    <!-- function: setnode -->
                    <button id= "deletenode" class="btn btn-default">Delete</button>
                    </div>

                    <form>
                        <input type="Submit" class="btn btn-default" value="Clear All" style="width:75px"">
                    </form>
                <!-- <div style="float:left;margin:30px 0 0 40px"> -->
                </div>


                <div class="canvas-container" style="float:center">
                    <canvas id="task-5" width="820" height="150" style="margin:0 40px 0 0; border: 1px solid black;"></canvas>
                </div>

            </div>
            <!-- ================================================================= -->
        </div>
    </div>

    <script>
        var task5Curve = null;
        var animation_play = false;
        var play_time = 0;
        var axis = 1;
        var meshid = -1; 
        var sliderflag = false;   

        var tx_nodes = new Array();
        var tx_tangents = new Array();

        var ty_nodes = new Array();
        var ty_tangents = new Array();
        
        var tz_nodes = new Array();
        var tz_tangents = new Array();


        var rx_nodes = new Array();
        var rx_tangents = new Array();

        var ry_nodes = new Array();
        var ry_tangents = new Array();
        
        var rz_nodes = new Array();
        var rz_tangents = new Array();

        
        function loadarm() {
            sliderflag = true;
            window.location.reload();
            console.log("reload for arm");
        }

        function loadm() {
            if(sliderflag){
                sliderflag = false;
                window.location.reload();

            }
        }
        
        function setupAssignment() {
            if(sliderflag){
                 setupTask("task-1", Task2);
                 console.log("arm shows");
            }else{
                setupTask("task-1", Task3);
                console.log("mesh shows");
            }

            // Set up the curves
            task5Curve = new CatmullRomSpline("task-5");
            // Call the draw function
            draw();
        }
        
        function draw() {
            task5Curve.drawTask5();
            
            requestAnimFrame(function() {
                draw();
            });
        }
        
        function clearCurve(canvasId) {
            if(canvasId == 5)
                task5Curve = new CatmullRomSpline("task-5");
        }
        
        window.requestAnimFrame = (function(callback) {
            return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
            function(callback) {
                window.setTimeout(callback, 1000 / 30);
            };
        })();
        
        function printValue(sliderID, textbox) {
            var x = document.getElementById(textbox);
            var y = document.getElementById(sliderID);
            x.value = y.value;
        }

        function changeText()
        {
            var text = document.getElementById('play');
            if(text.innerHTML === 'Play'){
                text.innerHTML = 'Stop';
            }else if(text.innerHTML === 'Stop'){
                text.innerHTML = 'Play';
            }
        }

        function loadmesh() {
        document.getElementById("myDropdown").classList.toggle("show");
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function(event) {
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }

    }

    </script>
</body>
</html>
